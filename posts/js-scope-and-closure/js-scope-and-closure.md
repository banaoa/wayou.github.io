## JavaScript 中的作用域与闭包


### 什么是作用域

变量存取的这套机制叫作作用域（Scope）。

要搞清楚变量的存取，先来看编译器的原理。

### 编译器的原理

尽管从语言划分上来说，JS 属于动态（dynamic）语言解释型（interpreted）语言，但事实上它也是编译型语言，只是不像正宗编译型语言那样编译得很彻底。

> * 动态语言，也叫弱类型语言，其变量所存储的值的类型由运行时决定。比如 JavaScript, Perl, Ruby, Python
> * 静态语言，也叫强类型语言，其变量所存储的值的类型编码时指定，编译阶段会进行强制检查，譬如 Java, C++, C#


> 关于解释型语言与编译型语言，严格来说，语言本身并不具备这一属性，只是看使用的环境。来自 [StackOverflow 的这个回答](https://stackoverflow.com/a/3265602/1553656)给出了一个列子：拿 Java 来说，有将 Java 代码转成 字节执行的 JVM 虚拟机，也有将其直接编译为机器码的 gcj，还有能够将其解释执行的bsh。但如果非要这样定义的话，
> * 解释型语言，由解释器解释执行，无需提前编译，即写即用，像 JavaScript 就是由浏览器解释执行。
> * 编译型语言，经过编译器转为机器码，直接在目标机器上运行。

#### 编译的内容

大多数语言的编译阶段会包含三个基本的内容，

* *词法分析*：将源码拆分成具有词法意义的最小单位，譬如对于这段代码 `var a = 2;`，可能分析出 `var`, `a`, `=`, `2`, 和 `;` 这些词法。
* *语法树解析*：将上面得到的一组词法根据其含意组装成语法树（AST/Abstract Syntax Tree），整个语法树从结构上完整重现了程序的逻辑。`var a = 2;` 人为可以理解出有一个变量声明的操作，然后有一个赋值的操作，所以解析出来的语法树是以一个变量声明节点（VariableDeclaration）开始，它有个子节点值为 `a`， 另一个子节点为赋值节点（AssignmentExpression），它包含一个子节点值为 `2`。 

* *可执行代码的生成*：将语法树转成机器码，这一步会因语言及平台的不同而差异巨大。





* [What is the difference between statically typed and dynamically typed languages?](https://stackoverflow.com/a/1517670/1553656)

